[tox]
envlist =
    py27,py34,py35,cover

[testing]
deps =
    {toxinidir}/../core
    pytest
covercmd =
    py.test --quiet \
      --cov=google.cloud.pubsub \
      --cov=unit_tests \
      --cov-config {toxinidir}/.coveragerc \
      unit_tests

[testenv]
commands =
    py.test --quiet {posargs} unit_tests
deps =
    {[testing]deps}

[testenv:cover]
basepython =
    python2.7
commands =
    {[testing]covercmd}
deps =
    {[testenv]deps}
    coverage
    pytest-cov

[testenv:emulator]
deps =
    {[testing]deps}
    psutil
setenv =
    GOOGLE_CLOUD_NO_PRINT=true
passenv =
    GOOGLE_CLOUD_DISABLE_GRPC
commands =
    python {toxinidir}/../system_tests/run_emulator.py --package=pubsub
